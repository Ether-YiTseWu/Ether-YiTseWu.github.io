
<!doctype html>

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KG2Z224XZ6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-KG2Z224XZ6');
    </script>
    <meta name="google-site-verification" content="Ql3h9a7FWrkphYKX-yT592Jf6HSDyIj04aFeDpDdOKA" />
        
    <meta charset="utf-8">
    <title>Kaggle | Yi-Tse Wu 吳乙澤</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='icon' href="/icons/favicon.ico">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <script src="/js/prism.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/prism.css">

    <style>
        .p1
        {
            font-family: "Microsoft JhengHei";
            font-weight: bold;
        }
        .p2
        { 
            border-bottom:6px #48b9d9 solid; padding-bottom:5px;
        }
        .p3
        { 
            border-bottom:1px #9aa4a7 solid; padding-bottom:2px;
        }
        body 
        {
            background-color: #f4f8f8;
        }
    </style>
</head>

<body>
    <div class = "d-flex flex-row container-fluid mt-4">
        <a class = "text-decoration-none link-dark mb-1" href="https://ether-yitsewu.github.io/" style = "margin-right: auto;"> 
            <h3> &nbsp; &nbsp; Home </h3>
        </a>
        <a class = "text-decoration-none link-dark mt-2" href="/about.html">
                <h5> About &nbsp; &nbsp; &nbsp; &nbsp; </h5>
        </a>
        <a class = "text-decoration-none link-dark mt-2" href="/post/post.html">
            <h5> Post &nbsp; &nbsp; &nbsp; &nbsp; </h5>
        </a>
        <a class = "text-decoration-none link-dark mt-2" href="/contact.html">
            <h5> Contact &nbsp; &nbsp; &nbsp; &nbsp; </h5>
        </a>
    </div>

    <hr/>

    <div class = "row">
        <div class = "col-12 mt-4 text-center">
            <div class = "p1"><h1>My solution to the competition, "Kaggle : House Prices"</h1></div>
        </div>
    </div>

    <br>

    <div class = "row">
        <div class = "col-3"></div>
        <div class = "col-6 bg-white p-4 text-left">
            <div class = "fs-5" style = "text-align:justify;">
                <span style = "font-size: 27px;">"K</span>aggle : House Prices<span style = "font-size: 27px;">"</span> is an online competition for everbody getting started prediction problems.
                The goal is to predict the hose prices based on the features like the house size, pool quality, and year sold.
                Because the competition is popular, there are many resources on Internet from enthusiastic netizens.
                Therefore, it's very suitable for the people who study data science and machine learning.
                In this article, I also share my solution to the Kaggle competition for increasing the positive self-learning community.
            </div>
            <br>
            <div class = "fs-5" style = "text-align:justify;">
                <span style = "font-size: 27px;">F</span>irstly, I would introduce my data preprocessing methods. 
                As the following figure shows, my preprocessing methods are consist of three parts, "NaN", "Category", and "Outlier".
                In the "NaN" part, I drop out the features whose NaN rate is higher than 10%.
                Then, I replace the NaN data with -1.
                In the "Category" part, I use one-hot encoding to make category features computable.
                In the "Outlier" part, I plot box figures to observe the features outlier condition for removing the extreme outliers.
                After the above processing, I start to build the model to predict the house prices.
                <br>
                <br>
                <div style = "text-align:center;">
                    <img src="/images/kaggle_01_preprocessing.jpg" alt="Kaggle Preprocessing" style = "max-width:100%; height:auto;">
                </div>
            </div>
            <br>
            <div class = "fs-5" style = "text-align:justify;">
                <span style = "font-size: 27px;">A</span>s the following figure shows, it's my model architecture. 
                The model is consist of three hidden layers.
                The hidden layers number is 256, 64, 32 seperately.
                As for the optimizer and activation function, I use "Nadam" and "gelu" to make the training process faster and stabler simultaneously.
                In addition, through the Dropout technique, I decrease the overfitting for acquiring a better score.
                <br>
                <br>
                <div style = "text-align:center;">
                    <img src="/images/kaggle_01_model.jpg" alt="Kaggle Model" style = "max-width:100%; height:auto;">
                </div>
            </div>
            <div class = "fs-5" style = "text-align:justify;">
                <br>
                <span style = "font-size: 27px;">F</span>inally, through the data preprocessing technique and a multilayer perceptron model, I beats 50% people and acquire 0.14607 score as the following figure shows.
                Hope this arcticle activate the people who study data science. 
                Thank you for your time to read this arcticle.
                <br>
                <br>
                <div style = "text-align:center;">
                    <img src="/images/kaggle_01_score.jpg" alt="Kaggle Score" style = "max-width:100%; height:auto;">
                </div>
            </div>

            <div class = "fs-5" style = "text-align:justify;">
                <br>
                <span style = "font-size: 27px;">P</span>s : the following figure is the model building and training program
                <br>
                <br>
            </div>
            
            <pre class="line-numbers"><code class='language-python'>
            import tensorflow as tf
            import matplotlib.pyplot as plt
            from keras.models import Sequential
            from keras.layers import Dense, Dropout, BatchNormalization

            ### Set up daat
            train_x = train_df_processing[feature_slect.drop(['SalePrice'], axis = 1).columns]
            train_y = train_df_processing['SalePrice']
            valid_x = validation_df_processing[feature_slect.drop(['SalePrice'], axis = 1).columns]
            valid_y = validation_df_processing["SalePrice"]

            ### Model Build
            tf.debugging.set_log_device_placement(True)
            model = Sequential()
            model.add(Dense(256, input_shape=(train_x.shape[1],), activation="gelu"))
            model.add(Dropout(0.025))
            model.add(Dense(64, activation="gelu"))
            model.add(Dropout(0.025))
            model.add(Dense(32, activation="gelu"))
            model.add(Dropout(0.025))
            model.add(Dense(1))

            ### Parameters setting
            optimize = tf.keras.optimizers.Nadam()
            model.compile(loss = "mae", optimizer = optimize, metrics=["mae"])

            ### Training
            callback1 = tf.keras.callbacks.EarlyStopping(monitor = 'val_loss', patience = 500)
            model.fit(train_x, train_y, epochs = 4000, batch_size = 64, verbose = False, validation_data = (valid_x, valid_y), callbacks=[callback1])

            ### Evaluate
            ## Plot
            train_loss = model.history.history["loss"]
            valid_loss = model.history.history["val_loss"]
            plt.figure(dpi = 200)
            plt.plot(range(len(train_loss)), train_loss, label="train loss")
            plt.plot(range(len(valid_loss)), valid_loss, label="valid loss")
            plt.legend()
            plt.xlabel("Epoch")
            plt.ylabel("mae")
            plt.show()

            print("Train Loss : ", train_loss[-1])
            print("Valid Loss : ", valid_loss[-1])
            </code></pre>
        </div>
    </div>

    <br>
    <hr/>

    <div class = "d-flex justify-content-center align-items-center BottomRemain pb-3">
        <div class = "fw-lighter fs-6">
            <small>
                © 2023 
                <a href=https://ether-yitsewu.github.io/ class = "text-decoration-none link-dark p3"> Yi-Tse Wu 吳乙澤</a>
                 All Rights Reserved 
                &nbsp; &nbsp; &nbsp; &nbsp; 
                Powerd by 
                <a href=https://getbootstrap.com/docs/5.3/getting-started/download/ class = "text-decoration-none link-dark p3"> Bootstrap</a>
                ,
                <a href=https://github.com/michalsnik/aos class = "text-decoration-none link-dark p3"> AOS</a>
                ,
                <a href=https://www.hitwebcounter.com/ class = "text-decoration-none link-dark p3"> hitwebcounter</a>
                &
                <a href="https://www.google.com.tw/intl/zh-TW/forms/about/" class = "text-decoration-none link-dark p3"> Google Forms </a>
            </small>
        </div>
        &nbsp; &nbsp; &nbsp; &nbsp; 
        <a href="https://www.hitwebcounter.com" target="_blank">
        <img src="https://hitwebcounter.com/counter/counter.php?page=8308749&style=0008&nbdigits=6&type=page&initCount=0" title="Free Counter" Alt="web counter"/></a>                                                              
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        AOS.init();
    </script>
</body>

</html>